---
layout: post
title: 热备份和主备倒换
tags: [System]
bigimg: /img/path.jpg
comments: true
---

* toc
{:toc}

通信系统稳定，可靠运行的关键技术是主备倒换。主备系统，通过设备冗余实现系统可靠性，稳定性和安全性。通常情况下，主设备正常工作，从设备处于备用状态。一旦满足一定触发条件，备用设备变为主设备，原主设备会转为备用。版本升级或则设备故障时可能会引发主备倒换。原则是倒换时底层不丢消息，倒换时通信能顺利进行。

# 热备份和主备倒换概述

简要介绍热备份和主备倒换的基本概念。

为了保证业务的不间断传输，网络中的通信设备需要具有**高可靠性**。通信设备因自身故障而导致业务中断的概率越低，其可靠性就越高。

在理论上，如果要彻底解决通信设备的可靠性问题，则需要将通信设备的软件和硬件都设计的完美无缺，使出现故障的概率为0，但这在实际环境下是不可能实现的。

因此，在实际环境下，为了提高通信设备的可靠性，除了提高通信设备的软件和硬件的质量外，最主要的方式就是**对通信系统中的重要节点采用冗余备份方式**。

冗余备份是指对通信系统中的重要节点，同时**提供多个功能相同的单元，以保证当某个单元出现故障时，此节点能依靠其它单元继续正常运行**。在提供的单元中，某些单元作为主用单元，负责节点的日常运行；其它单元作为备用单元，当主用单元出现故障时，备用单元能够及时和自动地投入运行，以保证通信系统的正常运行。

## 冗余备份方式
	
#### 1:1备份方式
	
“1:1”表示在两个单元中，一个是主用单元，一个是备用单元。备用单元处于上电状态，并备份主用单元的配置信息和某些动态信息。当主用单元出现故障时，备用单元快速地接替主用单元，以保证通信设备的正常运行。

#### 负载分担方式

参与负载分担的多个单元之间没有主备之分，所有单元同时支撑系统的工作。当一个单元出现故障时，它**所负责的业务能够及时地分担到其它单元上**，由其它单元支撑通信设备的正常运行。

#### 1+1备份方式
	
“1+1”表示在两个单元中，没有主备之分，两个单元**同时支撑系统的工作。当一个单元出现故障时，它所负责的业务能够及时地倒换到另一个单元上**，并且另一个单元能够单独支撑整个系统的正常运行。可以将1+1备份方式视为负载分担方式中的一种特殊情况。

## 硬件的冗余备份方式

为了保证具有高可靠性，对重要硬件单元进行了冗余备份，其中包括：主控板（Main Processing Unit）、监控板（Central Management Unit）、电源模块和风扇。

主控板
	支持双主控板。当主用主控板不能正常运行时，备用主控板将升为主用主控板，以保证的正常运行。

监控板
    支持双监控板。当主用监控板不能正常运行时，备用监控板将升为主用监控板，以保证的正常监控。

风扇框
	的风扇框中都装备了多个风扇。当一个风扇出现故障时，其他风扇调整转速。以保证正常的通风散热效果。

电源模块
	支持装备多个电源模块。有关电源模块的详细备份和配置方法，请参见电源模块配置和工作方式。

其中，主用主控板和备用主控板之间的倒换操作是通过热备份和主备倒换实现的。

## 主控板备份原理

所谓备份，就是指备用主控板作为主用主控板的镜像。在的日常运行过程中，主用主控板自动向备用主控板同步当前配置和某些动态信息，当备用主控板接替原来的主用主控板进行工作时，能够保证上的业务快速恢复。

热备份方式：

    如果备用主控板和主用主控板系统软件的版本一致，则备用主控板在启动后自动进入热备份状态。

    当备用主控板处于热备份状态时，它不处理业务并且不能执行命令，主用主控板可以向备用主控板实时同步配置信息和部分动态信息。当进行主备倒换时，备用主控板可以在最短时间内接替原来的主用主控板，以保证的业务不被中断。

为了保证主用主控板和备用主控板的配置文件一致，在保存配置文件时，会使备用主控板同步主用主控板的配置文件。

以下4种情况都能触发进行主备倒换：

    复位主用主控板
    在设备正常运行过程中插拔主用主控板
    执行主备倒换命令
    主用主控板出现故障

当发生以上情况时，将进行主备倒换，将业务快速平稳的切换到备用主控板上，以保证设备的正常运行。

# 热备份、温备份和冷备份

